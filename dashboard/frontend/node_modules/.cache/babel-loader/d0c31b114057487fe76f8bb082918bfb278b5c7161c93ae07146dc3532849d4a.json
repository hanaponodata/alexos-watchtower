{"ast":null,"code":"import _objectSpread from\"/Users/alex/watchtower/dashboard/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const API_BASE_URL=process.env.REACT_APP_API_URL||'';class ApiService{constructor(){this.baseURL=API_BASE_URL;this.retryAttempts=3;this.retryDelay=1000;this.timeout=10000;// 10 seconds\n}async request(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const url=\"\".concat(this.baseURL).concat(endpoint);const config=_objectSpread({headers:_objectSpread({'Content-Type':'application/json','X-Requested-With':'XMLHttpRequest'},options.headers),timeout:this.timeout},options);let lastError;for(let attempt=1;attempt<=this.retryAttempts;attempt++){try{const controller=new AbortController();const timeoutId=setTimeout(()=>controller.abort(),this.timeout);const response=await fetch(url,_objectSpread(_objectSpread({},config),{},{signal:controller.signal}));clearTimeout(timeoutId);if(!response.ok){const errorData=await response.json().catch(()=>({}));const error=new Error(errorData.detail||\"HTTP \".concat(response.status,\": \").concat(response.statusText));error.status=response.status;error.statusText=response.statusText;error.data=errorData;throw error;}return await response.json();}catch(error){lastError=error;// Don't retry on client errors (4xx) except 429 (rate limit)\nif(error.status&&error.status>=400&&error.status<500&&error.status!==429){throw error;}// Don't retry on abort (timeout)\nif(error.name==='AbortError'){throw new Error('Request timeout');}// Retry on server errors (5xx) or network errors\nif(attempt<this.retryAttempts){await this.delay(this.retryDelay*attempt);continue;}}}throw lastError||new Error('Request failed after multiple attempts');}delay(ms){return new Promise(resolve=>setTimeout(resolve,ms));}// Agent endpoints\nasync getAgents(){return this.request('/dashboard/api/agents');}async registerAgent(agentData){return this.request('/dashboard/api/agents',{method:'POST',body:JSON.stringify(agentData)});}async getAgent(uuid){return this.request(\"/dashboard/api/agents/\".concat(uuid));}async updateAgent(uuid,agentData){return this.request(\"/dashboard/api/agents/\".concat(uuid),{method:'PUT',body:JSON.stringify(agentData)});}async deleteAgent(uuid){return this.request(\"/dashboard/api/agents/\".concat(uuid),{method:'DELETE'});}// Health check\nasync healthCheck(){return this.request('/dashboard/api/health');}// System metrics\nasync getSystemMetrics(){return this.request('/dashboard/api/metrics');}// Events\nasync getEvents(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;let offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this.request(\"/dashboard/api/events?limit=\".concat(limit,\"&offset=\").concat(offset));}// Compliance\nasync getComplianceStatus(){return this.request('/dashboard/api/compliance');}}export const apiService=new ApiService();export default apiService;","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","ApiService","constructor","baseURL","retryAttempts","retryDelay","timeout","request","endpoint","options","arguments","length","undefined","url","concat","config","_objectSpread","headers","lastError","attempt","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","signal","clearTimeout","ok","errorData","json","catch","error","Error","detail","status","statusText","data","name","delay","ms","Promise","resolve","getAgents","registerAgent","agentData","method","body","JSON","stringify","getAgent","uuid","updateAgent","deleteAgent","healthCheck","getSystemMetrics","getEvents","limit","offset","getComplianceStatus","apiService"],"sources":["/Users/alex/watchtower/dashboard/frontend/src/utils/api.js"],"sourcesContent":["const API_BASE_URL = process.env.REACT_APP_API_URL || '';\n\nclass ApiService {\n  constructor() {\n    this.baseURL = API_BASE_URL;\n    this.retryAttempts = 3;\n    this.retryDelay = 1000;\n    this.timeout = 10000; // 10 seconds\n  }\n\n  async request(endpoint, options = {}) {\n    const url = `${this.baseURL}${endpoint}`;\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Requested-With': 'XMLHttpRequest',\n        ...options.headers,\n      },\n      timeout: this.timeout,\n      ...options,\n    };\n\n    let lastError;\n    \n    for (let attempt = 1; attempt <= this.retryAttempts; attempt++) {\n      try {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n        \n        const response = await fetch(url, {\n          ...config,\n          signal: controller.signal,\n        });\n        \n        clearTimeout(timeoutId);\n        \n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          const error = new Error(errorData.detail || `HTTP ${response.status}: ${response.statusText}`);\n          error.status = response.status;\n          error.statusText = response.statusText;\n          error.data = errorData;\n          throw error;\n        }\n\n        return await response.json();\n      } catch (error) {\n        lastError = error;\n        \n        // Don't retry on client errors (4xx) except 429 (rate limit)\n        if (error.status && error.status >= 400 && error.status < 500 && error.status !== 429) {\n          throw error;\n        }\n        \n        // Don't retry on abort (timeout)\n        if (error.name === 'AbortError') {\n          throw new Error('Request timeout');\n        }\n        \n        // Retry on server errors (5xx) or network errors\n        if (attempt < this.retryAttempts) {\n          await this.delay(this.retryDelay * attempt);\n          continue;\n        }\n      }\n    }\n    \n    throw lastError || new Error('Request failed after multiple attempts');\n  }\n\n  delay(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  // Agent endpoints\n  async getAgents() {\n    return this.request('/dashboard/api/agents');\n  }\n\n  async registerAgent(agentData) {\n    return this.request('/dashboard/api/agents', {\n      method: 'POST',\n      body: JSON.stringify(agentData),\n    });\n  }\n\n  async getAgent(uuid) {\n    return this.request(`/dashboard/api/agents/${uuid}`);\n  }\n\n  async updateAgent(uuid, agentData) {\n    return this.request(`/dashboard/api/agents/${uuid}`, {\n      method: 'PUT',\n      body: JSON.stringify(agentData),\n    });\n  }\n\n  async deleteAgent(uuid) {\n    return this.request(`/dashboard/api/agents/${uuid}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // Health check\n  async healthCheck() {\n    return this.request('/dashboard/api/health');\n  }\n\n  // System metrics\n  async getSystemMetrics() {\n    return this.request('/dashboard/api/metrics');\n  }\n\n  // Events\n  async getEvents(limit = 100, offset = 0) {\n    return this.request(`/dashboard/api/events?limit=${limit}&offset=${offset}`);\n  }\n\n  // Compliance\n  async getComplianceStatus() {\n    return this.request('/dashboard/api/compliance');\n  }\n}\n\nexport const apiService = new ApiService();\nexport default apiService; "],"mappings":"8HAAA,KAAM,CAAAA,YAAY,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,EAAE,CAExD,KAAM,CAAAC,UAAW,CACfC,WAAWA,CAAA,CAAG,CACZ,IAAI,CAACC,OAAO,CAAGN,YAAY,CAC3B,IAAI,CAACO,aAAa,CAAG,CAAC,CACtB,IAAI,CAACC,UAAU,CAAG,IAAI,CACtB,IAAI,CAACC,OAAO,CAAG,KAAK,CAAE;AACxB,CAEA,KAAM,CAAAC,OAAOA,CAACC,QAAQ,CAAgB,IAAd,CAAAC,OAAO,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CAClC,KAAM,CAAAG,GAAG,IAAAC,MAAA,CAAM,IAAI,CAACX,OAAO,EAAAW,MAAA,CAAGN,QAAQ,CAAE,CACxC,KAAM,CAAAO,MAAM,CAAAC,aAAA,EACVC,OAAO,CAAAD,aAAA,EACL,cAAc,CAAE,kBAAkB,CAClC,kBAAkB,CAAE,gBAAgB,EACjCP,OAAO,CAACQ,OAAO,CACnB,CACDX,OAAO,CAAE,IAAI,CAACA,OAAO,EAClBG,OAAO,CACX,CAED,GAAI,CAAAS,SAAS,CAEb,IAAK,GAAI,CAAAC,OAAO,CAAG,CAAC,CAAEA,OAAO,EAAI,IAAI,CAACf,aAAa,CAAEe,OAAO,EAAE,CAAE,CAC9D,GAAI,CACF,KAAM,CAAAC,UAAU,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CACxC,KAAM,CAAAC,SAAS,CAAGC,UAAU,CAAC,IAAMH,UAAU,CAACI,KAAK,CAAC,CAAC,CAAE,IAAI,CAAClB,OAAO,CAAC,CAEpE,KAAM,CAAAmB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACb,GAAG,CAAAG,aAAA,CAAAA,aAAA,IAC3BD,MAAM,MACTY,MAAM,CAAEP,UAAU,CAACO,MAAM,EAC1B,CAAC,CAEFC,YAAY,CAACN,SAAS,CAAC,CAEvB,GAAI,CAACG,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAL,QAAQ,CAACM,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,KAAO,CAAC,CAAC,CAAC,CAAC,CACzD,KAAM,CAAAC,KAAK,CAAG,GAAI,CAAAC,KAAK,CAACJ,SAAS,CAACK,MAAM,UAAArB,MAAA,CAAYW,QAAQ,CAACW,MAAM,OAAAtB,MAAA,CAAKW,QAAQ,CAACY,UAAU,CAAE,CAAC,CAC9FJ,KAAK,CAACG,MAAM,CAAGX,QAAQ,CAACW,MAAM,CAC9BH,KAAK,CAACI,UAAU,CAAGZ,QAAQ,CAACY,UAAU,CACtCJ,KAAK,CAACK,IAAI,CAAGR,SAAS,CACtB,KAAM,CAAAG,KAAK,CACb,CAEA,MAAO,MAAM,CAAAR,QAAQ,CAACM,IAAI,CAAC,CAAC,CAC9B,CAAE,MAAOE,KAAK,CAAE,CACdf,SAAS,CAAGe,KAAK,CAEjB;AACA,GAAIA,KAAK,CAACG,MAAM,EAAIH,KAAK,CAACG,MAAM,EAAI,GAAG,EAAIH,KAAK,CAACG,MAAM,CAAG,GAAG,EAAIH,KAAK,CAACG,MAAM,GAAK,GAAG,CAAE,CACrF,KAAM,CAAAH,KAAK,CACb,CAEA;AACA,GAAIA,KAAK,CAACM,IAAI,GAAK,YAAY,CAAE,CAC/B,KAAM,IAAI,CAAAL,KAAK,CAAC,iBAAiB,CAAC,CACpC,CAEA;AACA,GAAIf,OAAO,CAAG,IAAI,CAACf,aAAa,CAAE,CAChC,KAAM,KAAI,CAACoC,KAAK,CAAC,IAAI,CAACnC,UAAU,CAAGc,OAAO,CAAC,CAC3C,SACF,CACF,CACF,CAEA,KAAM,CAAAD,SAAS,EAAI,GAAI,CAAAgB,KAAK,CAAC,wCAAwC,CAAC,CACxE,CAEAM,KAAKA,CAACC,EAAE,CAAE,CACR,MAAO,IAAI,CAAAC,OAAO,CAACC,OAAO,EAAIpB,UAAU,CAACoB,OAAO,CAAEF,EAAE,CAAC,CAAC,CACxD,CAEA;AACA,KAAM,CAAAG,SAASA,CAAA,CAAG,CAChB,MAAO,KAAI,CAACrC,OAAO,CAAC,uBAAuB,CAAC,CAC9C,CAEA,KAAM,CAAAsC,aAAaA,CAACC,SAAS,CAAE,CAC7B,MAAO,KAAI,CAACvC,OAAO,CAAC,uBAAuB,CAAE,CAC3CwC,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACJ,SAAS,CAChC,CAAC,CAAC,CACJ,CAEA,KAAM,CAAAK,QAAQA,CAACC,IAAI,CAAE,CACnB,MAAO,KAAI,CAAC7C,OAAO,0BAAAO,MAAA,CAA0BsC,IAAI,CAAE,CAAC,CACtD,CAEA,KAAM,CAAAC,WAAWA,CAACD,IAAI,CAAEN,SAAS,CAAE,CACjC,MAAO,KAAI,CAACvC,OAAO,0BAAAO,MAAA,CAA0BsC,IAAI,EAAI,CACnDL,MAAM,CAAE,KAAK,CACbC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACJ,SAAS,CAChC,CAAC,CAAC,CACJ,CAEA,KAAM,CAAAQ,WAAWA,CAACF,IAAI,CAAE,CACtB,MAAO,KAAI,CAAC7C,OAAO,0BAAAO,MAAA,CAA0BsC,IAAI,EAAI,CACnDL,MAAM,CAAE,QACV,CAAC,CAAC,CACJ,CAEA;AACA,KAAM,CAAAQ,WAAWA,CAAA,CAAG,CAClB,MAAO,KAAI,CAAChD,OAAO,CAAC,uBAAuB,CAAC,CAC9C,CAEA;AACA,KAAM,CAAAiD,gBAAgBA,CAAA,CAAG,CACvB,MAAO,KAAI,CAACjD,OAAO,CAAC,wBAAwB,CAAC,CAC/C,CAEA;AACA,KAAM,CAAAkD,SAASA,CAAA,CAA0B,IAAzB,CAAAC,KAAK,CAAAhD,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,GAAG,IAAE,CAAAiD,MAAM,CAAAjD,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CACrC,MAAO,KAAI,CAACH,OAAO,gCAAAO,MAAA,CAAgC4C,KAAK,aAAA5C,MAAA,CAAW6C,MAAM,CAAE,CAAC,CAC9E,CAEA;AACA,KAAM,CAAAC,mBAAmBA,CAAA,CAAG,CAC1B,MAAO,KAAI,CAACrD,OAAO,CAAC,2BAA2B,CAAC,CAClD,CACF,CAEA,MAAO,MAAM,CAAAsD,UAAU,CAAG,GAAI,CAAA5D,UAAU,CAAC,CAAC,CAC1C,cAAe,CAAA4D,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}